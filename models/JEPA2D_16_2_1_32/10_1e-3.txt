(NYUDL) ruian7p@Ruian7P:~/Projects/JEPA$ python train.py
Config:
ModelConfig(Model='JEPA2D', teacher_forcing=True, out_channel=16, num_block=2, num_resblock=1, hidden_channel=32, sim_coeff=25, std_coeff=25, cov_coeff=1, reg_coeff=25, eps=0.0001, batch_size=256, epochs=10, lr=0.001)
Traceback (most recent call last):
  File "/home/ruian7p/Projects/JEPA/train.py", line 100, in <module>
    train(config)
  File "/home/ruian7p/Projects/JEPA/train.py", line 39, in train
    scheduler = torch.optim.lr_scheduler.ReduceLROnPlateau(
TypeError: __init__() got an unexpected keyword argument 'verbose'
(NYUDL) ruian7p@Ruian7P:~/Projects/JEPA$ ^C
(NYUDL) ruian7p@Ruian7P:~/Projects/JEPA$ python train.py
Config:
ModelConfig(Model='JEPA2D', teacher_forcing=True, out_channel=16, num_block=2, num_resblock=1, hidden_channel=32, sim_coeff=25, std_coeff=25, cov_coeff=1, reg_coeff=25, eps=0.0001, batch_size=256, epochs=10, lr=0.001)
Epoch 1:   0%|                                          | 0/574 [00:00<?, ?it/s]/home/ruian7p/Projects/JEPA/dataset.py:32: UserWarning: The given NumPy array is not writable, and PyTorch does not support non-writable tensors. This means writing to this tensor will result in undefined behavior. You may want to copy the array to protect its data or make it writable before converting it to a tensor. This type of warning will be suppressed for the rest of this program. (Triggered internally at /pytorch/torch/csrc/utils/tensor_numpy.cpp:203.)
  states = torch.from_numpy(self.states[i]).float().to(self.device)
/home/ruian7p/Projects/JEPA/train.py:62: UserWarning: Converting a tensor with requires_grad=True to a scalar may lead to unexpected behavior.
Consider using tensor.detach() first. (Triggered internally at /pytorch/aten/src/ATen/native/Scalar.cpp:22.)
  epoch_loss += loss.item()
Epoch 1: 100%|████████████████████████████████| 574/574 [01:55<00:00,  4.99it/s]
Epoch 1, Loss: 12.823165876940152
Epoch 2: 100%|████████████████████████████████| 574/574 [01:51<00:00,  5.17it/s]
Epoch 2, Loss: 6.183510562684062
Epoch 3: 100%|████████████████████████████████| 574/574 [01:48<00:00,  5.29it/s]
Epoch 3, Loss: 5.575410484852275
Epoch 4: 100%|████████████████████████████████| 574/574 [01:49<00:00,  5.26it/s]
Epoch 4, Loss: 5.2463031579393125
Epoch 5: 100%|████████████████████████████████| 574/574 [01:49<00:00,  5.22it/s]
Epoch 5, Loss: 5.067420574015442
Epoch 6: 100%|████████████████████████████████| 574/574 [01:49<00:00,  5.24it/s]
Epoch 6, Loss: 4.883320762720673
Epoch 7: 100%|████████████████████████████████| 574/574 [01:48<00:00,  5.28it/s]
Epoch 7, Loss: 4.758373130904673
Epoch 8: 100%|████████████████████████████████| 574/574 [01:46<00:00,  5.38it/s]
Epoch 8, Loss: 4.650337072199646
Epoch 9: 100%|████████████████████████████████| 574/574 [01:48<00:00,  5.29it/s]
Epoch 9, Loss: 4.585489896947083
Epoch 10: 100%|███████████████████████████████| 574/574 [01:52<00:00,  5.12it/s]
Epoch 10, Loss: 4.526227802349715
Training complete!
(NYUDL) ruian7p@Ruian7P:~/Projects/JEPA$ python main.py
Using device: cuda
Total Trainable Parameters: 30,954
/home/ruian7p/Projects/JEPA/dataset.py:32: UserWarning: The given NumPy array is not writable, and PyTorch does not support non-writable tensors. This means writing to this tensor will result in undefined behavior. You may want to copy the array to protect its data or make it writable before converting it to a tensor. This type of warning will be suppressed for the rest of this program. (Triggered internally at /pytorch/torch/csrc/utils/tensor_numpy.cpp:203.)
  states = torch.from_numpy(self.states[i]).float().to(self.device)
Probe prediction epochs:   0%|                           | 0/20 [00:00<?, ?it/s/home/ruian7p/Projects/JEPA/evaluator.py:160: UserWarning: Converting a tensor with requires_grad=True to a scalar may lead to unexpected behavior.
Consider using tensor.detach() first. (Triggered internally at /pytorch/aten/src/ATen/native/Scalar.cpp:22.)
  print(f"\nnormalized pred locations loss {per_probe_loss.item()}")

normalized pred locations loss 1.312445878982544

normalized pred locations loss 0.916918814182281597/156 [00:03<00:01, 31.32it/s]
Probe prediction step: 100%|██████████████████| 156/156 [00:05<00:00, 27.57it/s]
Probe prediction epochs:   5%|▉                  | 1/20 [00:05<01:47,  5.66s/it]
normalized pred locations loss 1.00903928279876744/156 [00:00<00:01, 109.49it/s]

normalized pred locations loss 0.92467653751373295/156 [00:01<00:00, 109.82it/s]
Probe prediction step: 100%|█████████████████| 156/156 [00:01<00:00, 109.25it/s]
Probe prediction epochs:  10%|█▉                 | 2/20 [00:07<00:57,  3.17s/it]
normalized pred locations loss 0.82347685098648071/156 [00:00<00:00, 110.09it/s]
Probe prediction step: 100%|█████████████████| 156/156 [00:01<00:00, 109.87it/s]
Probe prediction epochs:  15%|██▊                | 3/20 [00:08<00:40,  2.37s/it]
normalized pred locations loss 0.75413680076599123/156 [00:00<00:01, 110.17it/s]

normalized pred locations loss 0.67345023155212428/156 [00:01<00:00, 109.97it/s]
Probe prediction step: 100%|█████████████████| 156/156 [00:01<00:00, 109.75it/s]
Probe prediction epochs:  20%|███▊               | 4/20 [00:09<00:31,  2.00s/it]
normalized pred locations loss 0.76293045282363898/156 [00:00<00:00, 109.34it/s]
Probe prediction step: 100%|█████████████████| 156/156 [00:01<00:00, 109.15it/s]
Probe prediction epochs:  25%|████▊              | 5/20 [00:11<00:26,  1.79s/it]
normalized pred locations loss 0.62485271692276 12/156 [00:00<00:01, 110.78it/s]

normalized pred locations loss 0.56999713182449344/156 [00:01<00:00, 109.78it/s]
Probe prediction step: 100%|█████████████████| 156/156 [00:01<00:00, 109.51it/s]
Probe prediction epochs:  30%|█████▋             | 6/20 [00:12<00:23,  1.67s/it]
normalized pred locations loss 0.46664503216743475/156 [00:00<00:00, 109.30it/s]
Probe prediction step: 100%|█████████████████| 156/156 [00:01<00:00, 109.04it/s]
Probe prediction epochs:  35%|██████▋            | 7/20 [00:14<00:20,  1.59s/it]
normalized pred locations loss 0.3926366865634918       | 0/156 [00:00<?, ?it/s]

normalized pred locations loss 0.44731247425079346/156 [00:00<00:00, 109.64it/s]
Probe prediction step: 100%|█████████████████| 156/156 [00:01<00:00, 109.45it/s]
Probe prediction epochs:  40%|███████▌           | 8/20 [00:15<00:18,  1.54s/it]
normalized pred locations loss 0.42608717083930974/156 [00:00<00:01, 109.48it/s]

normalized pred locations loss 0.46272122859954834/156 [00:01<00:00, 109.26it/s]
Probe prediction step: 100%|█████████████████| 156/156 [00:01<00:00, 109.10it/s]
Probe prediction epochs:  45%|████████▌          | 9/20 [00:17<00:16,  1.50s/it]
normalized pred locations loss 0.35213297605514526/156 [00:00<00:00, 109.46it/s]
Probe prediction step: 100%|█████████████████| 156/156 [00:01<00:00, 109.25it/s]
Probe prediction epochs:  50%|█████████         | 10/20 [00:18<00:14,  1.48s/it]
normalized pred locations loss 0.37524148821830753/156 [00:00<00:01, 108.78it/s]

normalized pred locations loss 0.32307925820350647/156 [00:01<00:00, 109.70it/s]
Probe prediction step: 100%|█████████████████| 156/156 [00:01<00:00, 109.31it/s]
Probe prediction epochs:  55%|█████████▉        | 11/20 [00:19<00:13,  1.46s/it]
normalized pred locations loss 0.32540428638458257/156 [00:00<00:00, 109.35it/s]
Probe prediction step: 100%|█████████████████| 156/156 [00:01<00:00, 109.14it/s]
Probe prediction epochs:  60%|██████████▊       | 12/20 [00:21<00:11,  1.45s/it]
normalized pred locations loss 0.27899417281150822/156 [00:00<00:01, 109.13it/s]

normalized pred locations loss 0.39080694317817693/156 [00:01<00:00, 109.52it/s]
Probe prediction step: 100%|█████████████████| 156/156 [00:01<00:00, 109.22it/s]
Probe prediction epochs:  65%|███████████▋      | 13/20 [00:22<00:10,  1.45s/it]
normalized pred locations loss 0.33728244900703436/156 [00:00<00:00, 109.32it/s]
Probe prediction step: 100%|█████████████████| 156/156 [00:01<00:00, 108.86it/s]
Probe prediction epochs:  70%|████████████▌     | 14/20 [00:24<00:08,  1.44s/it]
normalized pred locations loss 0.36512443423271181/156 [00:00<00:01, 108.90it/s]

normalized pred locations loss 0.32699993252754210/156 [00:01<00:00, 108.93it/s]
Probe prediction step: 100%|█████████████████| 156/156 [00:01<00:00, 108.73it/s]
Probe prediction epochs:  75%|█████████████▌    | 15/20 [00:25<00:07,  1.44s/it]
normalized pred locations loss 0.30899149179458625/156 [00:00<00:00, 109.49it/s]
Probe prediction step: 100%|█████████████████| 156/156 [00:01<00:00, 109.43it/s]
Probe prediction epochs:  80%|██████████████▍   | 16/20 [00:27<00:05,  1.44s/it]
normalized pred locations loss 0.24747119843959808      | 0/156 [00:00<?, ?it/s]

normalized pred locations loss 0.29347443580627440/156 [00:00<00:00, 109.63it/s]
Probe prediction step: 100%|█████████████████| 156/156 [00:01<00:00, 109.08it/s]
Probe prediction epochs:  85%|███████████████▎  | 17/20 [00:28<00:04,  1.43s/it]
normalized pred locations loss 0.26234209537506104/156 [00:00<00:01, 109.12it/s]

normalized pred locations loss 0.25443109869956973/156 [00:01<00:00, 108.03it/s]
Probe prediction step: 100%|█████████████████| 156/156 [00:01<00:00, 108.30it/s]
Probe prediction epochs:  90%|████████████████▏ | 18/20 [00:29<00:02,  1.44s/it]
normalized pred locations loss 0.31067368388175964/156 [00:00<00:00, 108.80it/s]
Probe prediction step: 100%|█████████████████| 156/156 [00:01<00:00, 108.09it/s]
Probe prediction epochs:  95%|█████████████████ | 19/20 [00:31<00:01,  1.44s/it]
normalized pred locations loss 0.36223345994949343/156 [00:00<00:01, 109.00it/s]

normalized pred locations loss 0.32174146175384522/156 [00:01<00:00, 109.04it/s]
Probe prediction step: 100%|█████████████████| 156/156 [00:01<00:00, 108.78it/s]
Probe prediction epochs: 100%|██████████████████| 20/20 [00:32<00:00,  1.64s/it]
Eval probe pred: 100%|██████████████████████████| 62/62 [00:00<00:00, 63.19it/s]
Eval probe pred: 100%|██████████████████████████| 62/62 [00:00<00:00, 63.33it/s]
normal loss: 80.85929870605469
wall loss: 110.53876495361328