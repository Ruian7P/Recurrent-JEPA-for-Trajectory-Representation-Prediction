(NYUDL) ruian7p@Ruian7P:~/Projects/JEPA$ python train.py
Config:
ModelConfig(Model='JEPA2D', teacher_forcing=True, out_channel=16, num_block=2, num_resblock=1, hidden_channel=32, sim_coeff=25, std_coeff=25, cov_coeff=1, reg_coeff=25, eps=0.0001, batch_size=256, epochs=10, lr=0.0001)
Epoch 1:   0%|                                          | 0/574 [00:00<?, ?it/s]/home/ruian7p/Projects/JEPA/dataset.py:32: UserWarning: The given NumPy array is not writable, and PyTorch does not support non-writable tensors. This means writing to this tensor will result in undefined behavior. You may want to copy the array to protect its data or make it writable before converting it to a tensor. This type of warning will be suppressed for the rest of this program. (Triggered internally at /pytorch/torch/csrc/utils/tensor_numpy.cpp:203.)
  states = torch.from_numpy(self.states[i]).float().to(self.device)
/home/ruian7p/Projects/JEPA/train.py:62: UserWarning: Converting a tensor with requires_grad=True to a scalar may lead to unexpected behavior.
Consider using tensor.detach() first. (Triggered internally at /pytorch/aten/src/ATen/native/Scalar.cpp:22.)
  epoch_loss += loss.item()
Epoch 1: 100%|████████████████████████████████| 574/574 [01:55<00:00,  4.97it/s]
Epoch 1, Loss: 25.375048148922804
Epoch 2: 100%|████████████████████████████████| 574/574 [01:50<00:00,  5.17it/s]
Epoch 2, Loss: 13.001216511277788
Epoch 3: 100%|████████████████████████████████| 574/574 [01:53<00:00,  5.07it/s]
Epoch 3, Loss: 9.47306715569845
Epoch 4: 100%|████████████████████████████████| 574/574 [01:51<00:00,  5.16it/s]
Epoch 4, Loss: 7.896501409052141
Epoch 5: 100%|████████████████████████████████| 574/574 [01:51<00:00,  5.14it/s]
Epoch 5, Loss: 7.133210102440173
Epoch 6: 100%|████████████████████████████████| 574/574 [01:49<00:00,  5.23it/s]
Epoch 6, Loss: 6.737309175916665
Epoch 7: 100%|████████████████████████████████| 574/574 [01:50<00:00,  5.20it/s]
Epoch 7, Loss: 6.487795013168547
Epoch 8: 100%|████████████████████████████████| 574/574 [01:51<00:00,  5.14it/s]
Epoch 8, Loss: 6.373732923215274
Epoch 9: 100%|████████████████████████████████| 574/574 [01:49<00:00,  5.24it/s]
Epoch 9, Loss: 6.30874873370659
Epoch 10: 100%|███████████████████████████████| 574/574 [01:52<00:00,  5.11it/s]
Epoch 10, Loss: 6.258311942063973
Training complete!
(NYUDL) ruian7p@Ruian7P:~/Projects/JEPA$ python main.py
Using device: cuda
Total Trainable Parameters: 30,954
/home/ruian7p/Projects/JEPA/dataset.py:32: UserWarning: The given NumPy array is not writable, and PyTorch does not support non-writable tensors. This means writing to this tensor will result in undefined behavior. You may want to copy the array to protect its data or make it writable before converting it to a tensor. This type of warning will be suppressed for the rest of this program. (Triggered internally at /pytorch/torch/csrc/utils/tensor_numpy.cpp:203.)
  states = torch.from_numpy(self.states[i]).float().to(self.device)
Probe prediction epochs:   0%|                           | 0/20 [00:00<?, ?it/s/home/ruian7p/Projects/JEPA/evaluator.py:160: UserWarning: Converting a tensor with requires_grad=True to a scalar may lead to unexpected behavior.
Consider using tensor.detach() first. (Triggered internally at /pytorch/aten/src/ATen/native/Scalar.cpp:22.)
  print(f"\nnormalized pred locations loss {per_probe_loss.item()}")

normalized pred locations loss 1.6135146617889404

normalized pred locations loss 0.856446623802185198/156 [00:03<00:01, 31.94it/s]
Probe prediction step: 100%|██████████████████| 156/156 [00:05<00:00, 28.93it/s]
Probe prediction epochs:   5%|▉                  | 1/20 [00:05<01:42,  5.39s/it]
normalized pred locations loss 0.88472604751586914/156 [00:00<00:01, 102.80it/s]

normalized pred locations loss 0.73644858598709113/156 [00:01<00:00, 102.58it/s]
Probe prediction step: 100%|█████████████████| 156/156 [00:01<00:00, 102.67it/s]
Probe prediction epochs:  10%|█▉                 | 2/20 [00:06<00:56,  3.11s/it]
normalized pred locations loss 0.59333103895187388/156 [00:00<00:00, 108.37it/s]
Probe prediction step: 100%|█████████████████| 156/156 [00:01<00:00, 108.78it/s]
Probe prediction epochs:  15%|██▊                | 3/20 [00:08<00:39,  2.35s/it]
normalized pred locations loss 0.38998949527740482/156 [00:00<00:01, 109.63it/s]

normalized pred locations loss 0.40303891897201542/156 [00:01<00:00, 109.51it/s]
Probe prediction step: 100%|█████████████████| 156/156 [00:01<00:00, 109.25it/s]
Probe prediction epochs:  20%|███▊               | 4/20 [00:09<00:31,  1.98s/it]
normalized pred locations loss 0.34326174855232246/156 [00:00<00:00, 109.51it/s]
Probe prediction step: 100%|█████████████████| 156/156 [00:01<00:00, 109.15it/s]
Probe prediction epochs:  25%|████▊              | 5/20 [00:11<00:26,  1.78s/it]
normalized pred locations loss 0.28924983739852905/156 [00:00<00:01, 109.67it/s]

normalized pred locations loss 0.22623823583126068/156 [00:01<00:00, 109.89it/s]
Probe prediction step: 100%|█████████████████| 156/156 [00:01<00:00, 109.51it/s]
Probe prediction epochs:  30%|█████▋             | 6/20 [00:12<00:23,  1.66s/it]
normalized pred locations loss 0.23083376884460455/156 [00:00<00:00, 109.28it/s]
Probe prediction step: 100%|█████████████████| 156/156 [00:01<00:00, 108.76it/s]
Probe prediction epochs:  35%|██████▋            | 7/20 [00:14<00:20,  1.59s/it]
normalized pred locations loss 0.16052480041980743      | 0/156 [00:00<?, ?it/s]

normalized pred locations loss 0.17501519620418549/156 [00:00<00:00, 108.57it/s]
Probe prediction step: 100%|█████████████████| 156/156 [00:01<00:00, 108.69it/s]
Probe prediction epochs:  40%|███████▌           | 8/20 [00:15<00:18,  1.54s/it]
normalized pred locations loss 0.18550507724285126/156 [00:00<00:01, 108.32it/s]

normalized pred locations loss 0.20312154293060303/156 [00:01<00:00, 108.90it/s]
Probe prediction step: 100%|█████████████████| 156/156 [00:01<00:00, 108.54it/s]
Probe prediction epochs:  45%|████████▌          | 9/20 [00:16<00:16,  1.51s/it]
normalized pred locations loss 0.20227256417274475/156 [00:00<00:00, 109.62it/s]
Probe prediction step: 100%|█████████████████| 156/156 [00:01<00:00, 109.81it/s]
Probe prediction epochs:  50%|█████████         | 10/20 [00:18<00:14,  1.48s/it]
normalized pred locations loss 0.17374658584594727/156 [00:00<00:01, 109.65it/s]

normalized pred locations loss 0.17707984149456024/156 [00:01<00:00, 109.78it/s]
Probe prediction step: 100%|█████████████████| 156/156 [00:01<00:00, 109.62it/s]
Probe prediction epochs:  55%|█████████▉        | 11/20 [00:19<00:13,  1.46s/it]
normalized pred locations loss 0.18305966258049013/156 [00:00<00:00, 109.62it/s]
Probe prediction step: 100%|█████████████████| 156/156 [00:01<00:00, 109.46it/s]
Probe prediction epochs:  60%|██████████▊       | 12/20 [00:21<00:11,  1.45s/it]
normalized pred locations loss 0.13588863611221313/156 [00:00<00:01, 108.60it/s]

normalized pred locations loss 0.14885525405406952/156 [00:01<00:00, 109.11it/s]
Probe prediction step: 100%|█████████████████| 156/156 [00:01<00:00, 108.77it/s]
Probe prediction epochs:  65%|███████████▋      | 13/20 [00:22<00:10,  1.45s/it]
normalized pred locations loss 0.12345428764820099/156 [00:00<00:00, 109.09it/s]
Probe prediction step: 100%|█████████████████| 156/156 [00:01<00:00, 108.63it/s]
Probe prediction epochs:  70%|████████████▌     | 14/20 [00:24<00:08,  1.44s/it]
normalized pred locations loss 0.15242142975330353/156 [00:00<00:01, 109.12it/s]

normalized pred locations loss 0.13639508187770844/156 [00:01<00:00, 109.49it/s]
Probe prediction step: 100%|█████████████████| 156/156 [00:01<00:00, 108.94it/s]
Probe prediction epochs:  75%|█████████████▌    | 15/20 [00:25<00:07,  1.44s/it]
normalized pred locations loss 0.13460086286067963/156 [00:00<00:00, 108.82it/s]
Probe prediction step: 100%|█████████████████| 156/156 [00:01<00:00, 108.76it/s]
Probe prediction epochs:  80%|██████████████▍   | 16/20 [00:26<00:05,  1.44s/it]
normalized pred locations loss 0.12112194299697876      | 0/156 [00:00<?, ?it/s]

normalized pred locations loss 0.15569056570529938/156 [00:00<00:00, 109.22it/s]
Probe prediction step: 100%|█████████████████| 156/156 [00:01<00:00, 109.10it/s]
Probe prediction epochs:  85%|███████████████▎  | 17/20 [00:28<00:04,  1.44s/it]
normalized pred locations loss 0.14620152115821838/156 [00:00<00:01, 108.94it/s]

normalized pred locations loss 0.15619100630283356/156 [00:01<00:00, 109.60it/s]
Probe prediction step: 100%|█████████████████| 156/156 [00:01<00:00, 109.33it/s]
Probe prediction epochs:  90%|████████████████▏ | 18/20 [00:29<00:02,  1.43s/it]
normalized pred locations loss 0.16227573156356812/156 [00:00<00:00, 109.70it/s]
Probe prediction step: 100%|█████████████████| 156/156 [00:01<00:00, 109.39it/s]
Probe prediction epochs:  95%|█████████████████ | 19/20 [00:31<00:01,  1.43s/it]
normalized pred locations loss 0.11387725919485092/156 [00:00<00:01, 109.67it/s]

normalized pred locations loss 0.15035089850425725/156 [00:01<00:00, 109.63it/s]
Probe prediction step: 100%|█████████████████| 156/156 [00:01<00:00, 109.51it/s]
Probe prediction epochs: 100%|██████████████████| 20/20 [00:32<00:00,  1.63s/it]
Eval probe pred: 100%|██████████████████████████| 62/62 [00:00<00:00, 65.37it/s]
Eval probe pred: 100%|██████████████████████████| 62/62 [00:00<00:00, 65.45it/s]
normal loss: 38.36829376220703
wall loss: 48.76860046386719